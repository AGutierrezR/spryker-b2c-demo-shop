<?xml version="1.0"?>
<database name="zed"
          package="vendor/spryker/zed-package/src/ProjectA/Zed/Payment/Persistence/Propel"
          defaultIdMethod="native"
          defaultPhpNamingMethod="underscore"
          xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          xsi:noNamespaceSchemaLocation="http://xsd.propelorm.org/1.6/database.xsd">

    <table name="pac_payment" phpName="PacPayment">
        <column name="id_payment" required="true" type="INTEGER" primaryKey="true" />
        <column name="transaction" required="false" size="60" type="VARCHAR"/>
        <column name="method" required="true" size="50" type="VARCHAR"/>
        <column name="provider" required="false" size="50" type="VARCHAR"/>
        <foreign-key foreignTable="pac_sales_order" phpName="Order" refPhpName="Payment">
            <reference local="id_payment" foreign="id_sales_order"/>
        </foreign-key>
        <behavior name="timestampable" />
    </table>

    <table name="pac_payment_account" phpName="PacPaymentAccount">
        <column name="id_payment_account" required="true" type="INTEGER" primaryKey="true" autoIncrement="true" />
        <column name="fk_payment" required="true" type="INTEGER" />
        <column name="fk_payment_transaction" required="false" type="INTEGER" />

        <column name="receivable" required="true" type="INTEGER"/>
        <column name="cash" required="true" type="INTEGER"/>
        <column name="balance" required="true" type="INTEGER"/>
        <column name="delta" required="true" type="INTEGER"/>

        <column name="action" required="true" size="50" type="VARCHAR"/>
        <column name="message" required="false" size="255" type="VARCHAR" default="NULL"/>

        <behavior name="timestampable" />

        <foreign-key foreignTable="pac_payment" phpName="Payment" refPhpName="PaymentAccount">
            <reference local="fk_payment" foreign="id_payment"/>
        </foreign-key>
        <foreign-key foreignTable="pac_payment_transaction" phpName="PaymentTransaction" refPhpName="PaymentAccount">
            <reference local="fk_payment_transaction" foreign="id_payment_transaction"/>
        </foreign-key>
        <index>
            <index-column name="action" />
        </index>
    </table>

    <table name="pac_payment_transaction" phpName="PacPaymentTransaction">
        <column name="id_payment_transaction" required="true" type="INTEGER" primaryKey="true" autoIncrement="true"/>
        <column name="fk_payment" required="true" type="INTEGER" />

        <column name="reference_id" required="false" size="50" type="VARCHAR"/>
        <column name="event" required="true" size="50" type="VARCHAR"/>
        <column name="event_date" required="false" type="TIMESTAMP"/>
        <column name="is_outbound" required="true" type="BOOLEAN"/>
        <column name="is_success" required="true" type="BOOLEAN"/>
        <column name="message" required="false" size="255" type="VARCHAR"/>
        <column name="raw_request" required="false" type="LONGVARCHAR"/>
        <column name="raw_response" required="false" type="LONGVARCHAR"/>

        <behavior name="timestampable" />

        <foreign-key foreignTable="pac_payment" phpName="Payment" refPhpName="PaymentTransaction">
            <reference local="fk_payment" foreign="id_payment"/>
        </foreign-key>
        <index>
            <index-column name="event" />
            <index-column name="reference_id" />
        </index>
    </table>

    <table name="pac_payment_config" phpName="PacPaymentConfig">
        <column name="id_payment_config" required="true" type="INTEGER" primaryKey="true" autoIncrement="true"/>
        <column name="provider" required="true" size="50" type="VARCHAR"/>
        <column name="method" required="true" size="50" type="VARCHAR"/>
        <column name="identifier" required="true" size="50" type="VARCHAR"/>
        <column name="name" required="true" size="50" type="VARCHAR"/>
        <column name="is_active" required="true" type="BOOLEAN"/>
        <column name="value" required="false" size="50" type="VARCHAR"/>
        <column name="position" required="false" type="INTEGER"/>
        <column name="description" required="true" size="255" type="VARCHAR"/>

        <behavior name="timestampable" />

        <unique>
            <unique-column name="provider" />
            <unique-column name="method" />
            <unique-column name="identifier" />
        </unique>
    </table>

</database>
