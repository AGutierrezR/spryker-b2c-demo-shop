<?xml version="1.0" encoding="UTF-8"?>
<process xmlns="http://project-a.com/dwh-process"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://project-a.com/dwh-process ../../../../../../../../vendor/project-a/dwh-package/component/Dwh/process.xsd"
         id="cubes-update"
         description="Flushes and then primes the caches of the Mondrian by running a set of reports with different parameters">

    <initial-job id="flush-caches">
        <description>Flushes the caches of each cube + reloads the mondrian schema</description>
        <commands>
            <flush-cubes-cache/>
            <php-command class-name="Pac_Dwh_Model_Import_Command_LogRelationSizes"/>
        </commands>
    </initial-job>

    <job id="run-sales-report">
        <description>Runs the Sales report</description>
        <commands>
            <run-report report-id="sales"/>
        </commands>
    </job>

    <job id="run-everything-report">
        <description>Runs the Everything report</description>
        <commands>
            <run-report report-id="everything"/>
        </commands>
    </job>

    <job id="run-order-status-report">
        <description>Runs the Order status report</description>
        <commands>
            <run-report report-id="order-status"/>
        </commands>
    </job>

    <job id="run-campaign-clicks-report">
        <description>Runs the Campaign clicks report with different parameter combinations</description>
        <commands>
            <run-report report-id="campaign-clicks">
                <param name="time-unit">
                    <value>Days</value>
                    <value>Weeks</value>
                </param>
            </run-report>
        </commands>
    </job>

    <job id="run-omcampaigns-report">
        <description>Runs the Campaigns report with different parameter combinations</description>
        <dependencies>
            <dependency job="run-campaign-clicks-report"/>
        </dependencies>
        <commands>
            <run-report report-id="campaigns">
                <param name="time-unit">
                    <value>Days</value>
                    <value>Weeks</value>
                </param>
            </run-report>
        </commands>
    </job>

    <job id="run-conversions-report">
        <description>Runs the Conversions report with different parameter combinations</description>
        <dependencies>
            <dependency job="run-campaign-clicks-report"/>
        </dependencies>
        <commands>
            <run-report report-id="conversions">
                <param name="time-unit">
                    <value>Days</value>
                    <value>Weeks</value>
                </param>
            </run-report>
        </commands>
    </job>

</process>
