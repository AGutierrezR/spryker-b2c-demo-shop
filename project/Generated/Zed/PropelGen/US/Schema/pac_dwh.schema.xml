<?xml version="1.0"?>
<database name="zed"
          tablePrefix=""
          defaultIdMethod="native"
          defaultPhpNamingMethod="underscore"
          xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          xsi:noNamespaceSchemaLocation="http://xsd.propelorm.org/1.6/database.xsd">

    <table name="pac_dwh_report_permission" package="vendor/project-a/dwh-package/ProjectA/Zed/Dwh/Persistence"
            phpName="PacDwhReportPermission">
        <column name="id_dwh_report_permission" required="true" autoIncrement="true" type="INTEGER" primaryKey="true"/>
        <column name="fk_acl_user" required="true" type="INTEGER"/>
        <column name="report_id" type="VARCHAR" required="true"/>

        <foreign-key foreignTable="pac_acl_user" phpName="AclUser">
            <reference foreign="id_acl_user" local="fk_acl_user"/>
        </foreign-key>
    </table>

    <table name="pac_dwh_saiku_permission" package="vendor/project-a/dwh-package/ProjectA/Zed/Dwh/Persistence"
            phpName="PacDwhSaikuPermission">
        <column name="id_dwh_saiku_permission" required="true" autoIncrement="true" type="INTEGER" primaryKey="true"/>
        <column name="fk_acl_user" required="true" type="INTEGER"/>

        <foreign-key foreignTable="pac_acl_user" phpName="AclUser">
            <reference foreign="id_acl_user" local="fk_acl_user"/>
        </foreign-key>
    </table>

    <table name="pac_dwh_mdx_log" package="vendor/project-a/dwh-package/ProjectA/Zed/Dwh/Persistence"
            phpName="PacDwhMdxLog">
        <column name="id_dwh_mdx_log" required="true" autoIncrement="true" type="INTEGER" primaryKey="true"/>
        <column name="mdx_query" required="true" type="LONGVARCHAR"/>
        <column name="mdx_query_hash" required="true" type="VARCHAR"/>
        <column name="execution_time" required="true" type="DOUBLE"/>
        <column name="exception_message" required="false" type="LONGVARCHAR"/>
        <behavior name="timestampable"/>
        <index>
            <index-column name="mdx_query_hash"/>
        </index>
    </table>


    <table name="pac_dwh_import_run" package="vendor/project-a/dwh-package/ProjectA/Zed/Dwh/Persistence"
            phpName="PacDwhImportRun">
        <column name="id_dwh_import_run" required="true" autoIncrement="true" type="INTEGER" primaryKey="true"/>
        <column name="execution_time" required="true" type="DOUBLE"/>
        <column name="succeeded" type="BOOLEAN" required="true"/>
        <behavior name="timestampable"/>
    </table>

    <table name="pac_dwh_process_run" package="vendor/project-a/dwh-package/ProjectA/Zed/Dwh/Persistence"
            phpName="PacDwhProcessRun">
        <column name="id_dwh_process_run" required="true" autoIncrement="true" type="INTEGER" primaryKey="true"/>
        <column name="process_name" required="true" type="VARCHAR"/>
        <column name="execution_time" required="true" type="DOUBLE"/>
        <column name="fk_dwh_import_run" required="false" type="INTEGER"/>
        <behavior name="timestampable"/>

        <index>
            <index-column name="process_name"/>
            <index-column name="created_at"/>
        </index>

        <foreign-key foreignTable="pac_dwh_import_run"  phpName="PacDwhImportRun" onDelete="CASCADE">
            <reference foreign="id_dwh_import_run" local="fk_dwh_import_run"/>
        </foreign-key>
    </table>

    <table name="pac_dwh_job_run" package="vendor/project-a/dwh-package/ProjectA/Zed/Dwh/Persistence"
            phpName="PacDwhJobRun">
        <column name="id_dwh_job_run" required="true" autoIncrement="true" type="INTEGER" primaryKey="true"/>
        <column name="job_name" required="true" type="VARCHAR"/>
        <column name="process_name" required="true" type="VARCHAR"/>
        <column name="execution_time" required="true" type="DOUBLE"/>
        <column name="fk_dwh_process_run" required="false" type="INTEGER"/>
        <behavior name="timestampable"/>

        <index>
            <index-column name="process_name"/>
        </index>
        <index>
            <index-column name="job_name"/>
            <index-column name="created_at"/>
        </index>

        <foreign-key foreignTable="pac_dwh_process_run"  phpName="PacDwhProcessRun" onDelete="CASCADE">
            <reference foreign="id_dwh_process_run" local="fk_dwh_process_run"/>
        </foreign-key>
    </table>

    <table name="pac_dwh_relation_size" package="vendor/project-a/dwh-package/ProjectA/Zed/Dwh/Persistence"
            phpName="PacDwhRelationSize">
        <column name="id_dwh_relation_size" required="true" autoIncrement="true" type="INTEGER" primaryKey="true"/>
        <column name="relation" type="VARCHAR" required="true"/>
        <column name="size" required="true" type="BIGINT"/>
        <index>
            <index-column name="relation"/>
            <index-column name="created_at"/>
        </index>

        <behavior name="timestampable"/>
    </table>

    <table name="pac_dwh_query_token" package="vendor/project-a/dwh-package/ProjectA/Zed/Dwh/Persistence"
            phpName="PacDwhQueryToken">
        <column name="id_dwh_query_token" required="true" autoIncrement="true" type="INTEGER" primaryKey="true"/>
        <column name="uid" required="true" type="VARCHAR"/>
        <column name="div" required="true" type="VARCHAR"/>
        <column name="type" required="true" type="VARCHAR"/>
        <column name="query" required="true" type="LONGVARCHAR"/>
        <column name="args" required="true" type="VARCHAR"/>

        <behavior name="timestampable"/>
    </table>

</database>
